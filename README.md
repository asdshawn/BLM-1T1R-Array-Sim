# BLM-1T1R-Array-Sim üì¶‚ö°

A complete simulation framework for a 2x2 **Bipolar Liquid Memory (BLM)** array using the **1T1R (1 Transistor - 1 Resistor)** architecture. This project features a physics-based Verilog-A model, SPICE netlists, and a fully containerized Docker environment for automated waveform generation.

No complex installation is required\! We use **Docker** to package all necessary tools (ngspice, OpenVAF, Ghostscript).

-----

## üìö What is BLM?

**BLM (Bipolar Liquid Memory)** is a hypothetical non-volatile memory technology that stores data by changing its resistance state.

  * **SET Operation (Write 1):** Applying a positive voltage ($>0.75V$) switches the device to a **Low Resistance State (LRS)**.
  * **RESET Operation (Write 0):** Applying a negative voltage ($<-0.92V$) switches the device back to a **High Resistance State (HRS)**.

In this project, we simulate a **2x2 Array** using the **1T1R architecture**. Every memory cell is paired with a selector transistor (NMOS) to ensure precise control and prevent electrical interference (sneak paths) between neighboring cells.

-----

## üìä Simulation Results & Analysis

### 1\. Single Cell Verification (1T1R)

Below is an analysis of the simulation results generated by `1T1R_cell_v2.sp`, verifying the correct read/write operations of a single 1T1R cell.

* **Control Signals (Input)**

  <img width="512" height="525" alt="1t1r_control" src="https://github.com/user-attachments/assets/c9d598bc-17d3-4d2d-8571-957107d157bf" />

  This plot shows the control signals applied to the 1T1R cell:

    * **Red Line (`v(wl)`) - Word Line:** \* The Word Line (WL) controls the NMOS selector. It stays at **2.0V** during active operations (5ms - 60ms) to turn on the transistor, allowing current to flow to the memory cell.
    * **Blue Line (`v(bl)+6`) - Bit Line:** \* The Bit Line (BL) provides the programming voltages. (Shifted by +6V for visibility).
        * **10ms (SET):** A +4.0V pulse is applied to write "1".
        * **25ms (READ 1):** A +0.5V pulse reads the state.
        * **40ms (RESET):** A -4.0V pulse is applied to write "0".
        * **55ms (READ 0):** A +0.5V pulse reads the state again.

* **Cell Response (Output)**

  <img width="512" height="524" alt="1t1r_current" src="https://github.com/user-attachments/assets/7626258d-03d2-4273-9e6a-e1e1221c5f10" />
  
  This plot shows the current flowing through the memory cell (Log Scale), confirming successful state switching:

    * **SET Operation (10ms):** \* The current spikes to **\~10‚Åª¬≥ A (mA range)**. The high current confirms the device has switched to the **Low Resistance State (LRS)**.
    * **READ "1" (25ms):** \* We see a distinct current level of **\~10‚Åª‚Å∂ A (¬µA range)**. This confirms the cell **remembered** the "1" state after the SET voltage was removed.
    * **RESET Operation (40ms):** \* A large current spike occurs again as the negative voltage resets the device.
    * **READ "0" (55ms):** \* The current drops significantly to **\~10‚Åª¬π¬≤ A (pA range)**, which is the noise floor. This confirms the device has successfully switched back to the **High Resistance State (HRS)** and is effectively "off".

**Conclusion:** The huge contrast between the READ "1" current (\~¬µA) and READ "0" current (\~pA) demonstrates a wide **Memory Window**, validating the functionality of the BLM model.

### 2\. Array Selectivity Test (2x2 Array)

<img width="512" height="526" alt="array_current" src="https://github.com/user-attachments/assets/de02f3b1-8e9c-47aa-b97b-18b42d9cfd9d" />

This plot demonstrates the **selectivity** of the 1T1R array, proving that operations on a target cell do not disturb its neighbors.

  * **Simulation Setup:**

      * **Target Cell (0,0):** Connected to Active Wordline (`WL0`) and Active Bitline (`BL0`).
      * **Neighbor Cell (0,1):** Connected to Active Wordline (`WL0`) but Inactive Bitline (`BL1`).

  * **Analysis of Results:**

      * **Red Line (`abs(i(v_bl0))`) - Target Cell Current:**

          * We see a large current pulse at **40ms-45ms**. This corresponds to the **RESET** operation, where the cell switches from Low Resistance (LRS) back to High Resistance (HRS).
          * The magnitude is **\~1.7 mA**, confirming that the NMOS transistor successfully drove enough current to reset the memory element.
          * *(Note: The SET current at 10ms is smaller due to the source-follower effect of the NMOS, but the successful RESET at 40ms proves the SET operation worked.)*

      * **Blue Line (`abs(i(v_bl1))`) - Neighbor Cell Current:**

          * The current remains perfectly flat at **0 A**.
          * Even though the Wordline (`WL0`) was turned on for both cells, the Neighbor Cell (`BL1`) received 0V on its Bitline.
          * This confirms **zero crosstalk**: writing to the target cell does not cause any accidental current flow or state change in the adjacent cell.

**Conclusion:** The 1T1R architecture effectively isolates cells within the array, allowing for precise, disturbance-free programming.

### 3\. Distributed RC Parasitics Analysis (2x2 Array)



This simulation introduces **distributed wire resistance ($10\Omega$/cell)** and **capacitance ($30aF$/cell)** to model realistic interconnect effects.

* **IR Drop Analysis (Voltage):**

    * **Red Line (`v(src_bl0)`):** The ideal voltage pulse generated by the driver.
    * **Blue Line (`v(bl0_n0)`):** The actual voltage arriving at the memory cell node.
    * **Observation:** The two lines overlap almost perfectly.
    * **Analysis:** For a small 2x2 array, the cumulative wire resistance (\~$20\Omega$) is negligible compared to the device resistance ($1k\Omega \sim 1M\Omega$). This confirms that **signal integrity is maintained** in small-scale arrays, establishing a baseline for future large-scale (e.g., 64x64) IR drop studies.

* **Selectivity with Parasitics (Current):**

    * **Red Line:** Target cell current shows a clear **RESET pulse (\~1.7 mA)**, indicating successful writing.
    * **Blue Line:** Neighbor cell current remains at **0 A**.
    * **Conclusion:** Even with non-ideal RC parasitic elements, the 1T1R architecture maintains **perfect selectivity**, effectively isolating the target cell from disturbances.

-----

## üíª System Requirements

To run this project, you need a computer capable of running Docker.

  * **Windows Users:** Windows 10 (2004+) or Windows 11 with **WSL 2** enabled.
  * **Linux Users:** Any modern distribution (Ubuntu, Debian, etc.).
  * **Mac Users:** macOS with Docker Desktop installed.
  * **Hardware:** x64 processor, at least 4GB RAM.

-----

## üõ†Ô∏è Installation Guide (Step-by-Step)

### Step 1: Install WSL 2 (Windows Users Only)

If you are on Windows, you need a Linux environment to run the scripts easily.

1.  Open **PowerShell** or **Command Prompt** as Administrator.
2.  Type the following command and press Enter:
    ```powershell
    wsl --install
    ```
3.  **Restart your computer** when prompted.
4.  After restarting, Ubuntu will open automatically. Follow the instructions to create a username and password.

### Step 2: Install Docker

Docker allows us to package the complex simulation tools (ngspice, OpenVAF) into a single "box".

**For Windows / Mac:**

1.  Download **Docker Desktop** from [docker.com](https://www.docker.com/products/docker-desktop/).
2.  Run the installer. **(Windows Users: Check "Use WSL 2 based engine")**.
3.  Start Docker Desktop and wait for the engine to start.

**For Linux:**

  * Follow the official guide to install Docker Engine for your distribution.

### Step 3: Verify Docker Installation

Open your terminal (Ubuntu/WSL or Command Prompt) and run the following test command:

```bash
docker run hello-world
```

  * **Success:** If you see a message saying `Hello from Docker!`, you are ready to go.
  * **Failure:** If you see `permission denied` or `connect to the Docker daemon socket`, please refer to the **Troubleshooting** section below.

### Step 4: Get the Project Files

1.  Open your terminal.
2.  Create a folder and download the project files (or clone this repository).
    ```bash
    mkdir BLM_Project
    cd BLM_Project
    # (Ensure .va, .sp, Dockerfile, and run.sh are in this folder)
    ```

-----

## üöÄ How to Run the Simulation

We have prepared a one-click script (`run.sh`) that handles everything: compiling the model, running the simulation, and converting the results into images.

### 1\. Build the Environment

First, build the Docker image. This only needs to be done **once**.

```bash
docker build -t blm_env .
```

### 2\. Run the Simulation

Use the following command to start the simulation. This command automatically detects if it's running on the host or inside Docker.

**Syntax:**

```bash
./run.sh <SPICE_File> <VerilogA_File>
```

**Example (Running the 2x2 Array Test):**

```bash
./run.sh 2x2_array_v2.sp BLM_memory_v2.va
```

### 3\. View the Results

Once the script finishes, check your project folder. You will see new **.png** image files inside the `plot/` directory (e.g., `plot/array_current.png`).

-----

## üìÇ File Structure

  * **`Dockerfile`**: Builds the simulation environment (Rust, ngspice, Ghostscript).
  * **`run.sh`**: Automation script for compiling models and plotting results.
  * **`BLM_memory_v2.va`**: Physics-based Verilog-A model of the BLM memory cell.
  * **`1T1R_cell_v2.sp`**: SPICE netlist for single-cell verification.
  * **`2x2_array_v2.sp`**: SPICE netlist for the 2x2 array simulation.

-----

## üîÆ Future Work & Roadmap

This project establishes a solid foundation for 1T1R memory array simulation. Potential future enhancements and research directions include:

### 1. Array Scaling (N x M Crossbar)
* **Objective:** Expand the current 2x2 array to larger sizes (e.g., 16x16, 64x64).
* **Challenge:** Evaluate the impact of **IR Drop** (voltage drop along the metal lines) and **Sneak Paths** in larger arrays.
* **Implementation:** Parameterize the netlist generation to automatically create larger matrices with interconnect resistance.

### 2. Peripheral Circuit Design
* **Objective:** Replace ideal voltage sources (PWL) with realistic CMOS control circuits.
* **Key Components:**
    * **Sense Amplifiers (SA):** To detect the small current difference between "0" and "1" states automatically.
    * **Row/Column Decoders:** To select specific wordlines and bitlines digitally.
    * **Write Drivers:** To generate the required SET/RESET pulses on-chip.

### 3. Monte Carlo & Variability Analysis
* **Objective:** Simulate manufacturing imperfections.
* **Method:** Introduce statistical variations to key parameters (e.g., `$V_{Tset}$, $R_{on}$, $V_{th}$ of NMOS`) using Gaussian distributions. This helps estimate the **yield** and **reliability** of the memory array.

### 4. Advanced Physics Modeling
* **Objective:** Re-integrate the **Negative Differential Resistance (NDR)** model into the array simulation.
* **Context:** Currently, we use a stabilized "Positive Resistance" model for the array to ensure convergence. Future work could focus on optimizing the SPICE solver settings (e.g., `gmin`, `abstol`) to support the full physical NDR model in a large-scale array.

### 5. 1S1R Architecture Exploration
* **Objective:** Replace the NMOS transistor with a **Two-Terminal Selector (OTS)**.
* **Benefit:** 1S1R (One Selector - One Resistor) enables much higher density (3D stacking) compared to 1T1R, similar to **3D XPoint** technology.

-----

## ‚ùì Troubleshooting

**Error: `docker: permission denied while trying to connect to the Docker daemon socket`**

  * **Cause:** On standard Linux installations, the current user does not have permission to access Docker.
  * **Fix:** Add your user to the `docker` group to run commands without `sudo`. Run these commands:
    ```bash
    sudo groupadd docker
    sudo usermod -aG docker $USER
    newgrp docker
    ```
    *Try running `docker run hello-world` again after this.*

**Error: `bad interpreter: /bin/bash^M: No such file or directory`**

  * **Cause:** The `run.sh` file has Windows-style line endings (`CRLF`) instead of Linux-style (`LF`).
  * **Fix:** Run this command in your terminal:
    ```bash
    sed -i 's/\r$//' run.sh
    ```

**Error: `docker: command not found`**

  * **Cause:** Docker is not installed or not running.
  * **Fix:** Open Docker Desktop (Windows/Mac) and ensure the status is "Running". Windows users should verify "WSL Integration" is enabled in Docker settings.
